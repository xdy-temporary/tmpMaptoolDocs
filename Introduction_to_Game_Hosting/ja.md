{{\#customtitle:はじめてのゲーム・ホスティング|はじめてのゲーム・ホスティング}} __TOC__

はじめに
--------

[初めてのマップ作製で述べたように](Introduction_to_Mapping/ja "wikilink")、MapTool は、RPGセッションで使用する仮想マップの作成機能と仮想『ミニチュア』（マップツールでは[トークンという用語が使われる](Introduction_to_Tokens/ja "wikilink")）機能を提供する。この機能はテーブル上に広げた地図とミニチュアによく似ている。実のところ、MapTool が『仮想テーブル』、『VTT（訳注：virtual tabletopの略）』と呼ばれるゆえんだ。このガイドでは『インターネット上で他のプレイヤーとマップを共有する』ことの基礎を、手順を追って説明しよう。

**注：**マップツールが*役立つ*のはオンライン上のプレイ*だけ*ではない。実物のマップではできないことが仮想マップで実現できるので、多くの人がオフラインのセッションでもマップツールを使用している。おまけに、マップ上にコーラをぶちまける心配もしなくて良い。しかしここではオンラインで遊ぶことを前提に案内を進める。

『初めてのマップ作成』ではマップツールの入手、使い始め、マップと地図の配置の基礎について説明している。また、キャンペーン・ファイルの保存、マップの移動と拡大・縮小、トークンの移動についても説明している。これらはプログロラムの最も重要な機能であり、これなしでは残りの説明をよんでも役には立たないだろう。

ホストを立てても君のゲームに誰も接続しなければまったく楽しくないので、このガイドの最後のセクションではマップツール・サーバーへの接続方法を説明している。接続方法を友人に伝える必要があるので、そのセクションを必ず読むように!

なお、このガイドではオンライン・セッションを*ホストする*ことを扱うので、『君』とは『サーバーを実行している人』のことだ。

基本仕様
--------

オンライン・セッションで使う場合、マップツールは*クライアント・サーバー*アーキテクチャを用いる。つまり、ある人物（通常GMだが、そうでなくても良い） がマップツールを*サーバー*として開始させて、メンバーの他の人はそのサーバーに*クライアント*として接続する。

サーバーを開始し参加者が接続したなら、キャンペーン・ファイル（全てのマップ、トークン、その他の情報を含む）はプレイヤー全員に共有されるので、同じマップを見て、仲間が動かしたトークンの移動を見る事ができ、チャット・ウィンドウにテキストを入力することができる。あとは大いに楽しむだけだ。

ネットワークに関する用語
------------------------

『仮想ゲーム卓』プログラムを含む、多くのクライアント・サーバー型のアプリケーションと同じように、マップツール・セッションの準備における課題の一つとして、君のマップツール・サーバーに接続する友人を、君のホーム・ネットワークに接続できるように設定する事だ。

マップツールをインターネット上でホストできるように設定するにはいくつかの方法がある。UPnP、ポート・フォワーディング、外部仮想プライベート・ネットワーク（VPN）ソフトのパッケージ。君のPC、接続プロバイダ、ハードウェア（ケーブル・モデム、DSLモデム、ルーターなど）により、どの方法を選ぶか決まるだろう。ホーム・ネットワークやネットワーク機器にはたくさんの種類があるので、成功を得るための方法を一つにしぼる事はできない。

### UPnP

ポート・フォワーディングに変わるものは（ルーターにその機能が備わっていれば）*UPnP*（*ユニバーサル・プラグ・アンド・プレイ*の略）と呼ばれる。この機能は、ルーターに「ポートXYZの通信はここに！」と指示する代りに、「ゲームをする間、ポートXYZを通らなくてはならないので空けといてくれないかな？」と言うようなものだ。

言いかえれば、ポートとトラフィックの出入りをシームレスに、シンプルに扱う機能だ。もちろん、常にUPnPがサポートされているわけではないのが欠点であり、 君のネットワークが対応しているかどうか考えなればならないだろう。とはいえ、君のネットワーク機器がUPnPをサポートしているのであれば、それが君の MapTool サーバーを稼働する方法として*何にもまして*最も簡単な方法である。

### ポートフォワーディング

ルーターや物理ファイアウォールを使用しているホームネットワークでは、*ポートフォワーディング*の設定が必要となるだろう。これは君のネットワークに訪れ、特定のポートの上に到着する情報があなたのネットワークの中で適当な場所に送られるメカニズムである。これはマップツール・サーバーを立てている君にとって重要であり、仲間に正しい場所の情報を伝えなければならない。

ポートフォワーディングの設定の特定の部分は機器に依存するので説明書を確認しなければならないだろう。しかし、基本的な考え方はルーター／スイッチ／ファイアウォールに2つのことを示すということだ：

1.  どのポートをマップツールが使うのか（より多くのマップツールのポートは後ほど）。これはルーターに「情報は○○ポートからやって来るので注意せよ」と伝えることだ。
2.  その情報の行き先は、ネットワーク内のどのコンピューターなのか。つまり「情報が○○ポートへ到着したら、ここへ送れ」
    1.  ついでながら、ポートフォワーディングの設定は、ルーターに、送信するデータがどこに到達できるかを伝える。

以上がポートフォワーディングの概要だ。ほとんどのルータ（特に、セキュアにかつ適切に構成されているものなら）では無作為に入って来る情報は到達できないため、上記の設定をしなければならない。

### より多くの、より良いネットワークについての情報

Azhreiにより投稿された素晴らしい[FAQ](http://forums.rptools.net/download/file.php?id=116)（[MapTool Forums](http://forums.rptools.net)内）をしっかりと理解したので、ネットワークについての綿密なセクションを書き始める準備が整った。ポートフォワーディング、ルーターの設定、ネットワークに関する作業全般になじみがないなら、このFAQをぜひ読んでほしい。

ネットワークの設定やホームネットワークの管理に慣れているなら（特にソフトをサーバーとして稼働させたり、ポートフォワーディングの設定をすることができるのなら）、マップツールをサーバーとして稼働させることは雑作もないことだろう。基本的にルーターにマップツールのネットワークトラフィックを通過させるためにルーターを設定しなければならない。

君のネットワーク機器に固有のポートフォワーディングの設定情報が必要なら、[Portforward.com](http://www.portforward.com)に大量にある特定のネットワーク機器、特定のソフトの操作手順の書かれた文書の中から探し出してくれ。

その他、上記のこと全てが意味不明なら、[Networking FAQ](http://forums.rptools.net/download/file.php?id=116)を読んでくれ！わからないことは全て解決するぞ！

それでは作業に取りかかろう。

マップツール・サーバーを開始する
--------------------------------

### 前提

これ以降の説明では、君のネットワークがマップツールのトラフィックを（ポートフォワーディングやUPnPを通して）扱えるように設定済みであることを前提として書かれている。そうではないなら、君の仲間が使用可能なサーバーを立ち上げる前に、その方法を理解しなければならないだろう。

### サーバー開始のダイアログ（Start Server ダイアログ）

![](mt-file-menu-startserv.jpg "mt-file-menu-startserv.jpg")

![](mt-start-server.jpg "mt-start-server.jpg")

1. **File → Start Server**を選択。

2. **Start Server** ダイアログが表示される。ここにはたくさんのオプション項目がある。

### サーバー・オプションと設定

#### サーバー構成の設定を行う

-   **Username**：この項目は、チャットやConnectionsウィンドウに表示される名称だ。君の好きな名前を設定できる。
-   **Role**：このドロップダウンの項目は、君が*どの種類のユーザー*であるかマップツールに伝えるものだ。君はGM（すなわち全宇宙の支配者）を担当するのか？ それともプレイヤー（GMの気まぐれに付き合う者、またはプレイヤー機能のみ使える者）かな？セッションでは1名以上のGMを持つこともできる！
-   **Port**：*非情に重要な設定*であり、ルーターへ転送できるように設定したポートを MapToll に伝える部分だ。間違ったポートを指定した場合、MapTool の通信は君のネットワークへ入ることも出ることも入ることもできないだろう。つまりゲームはできないということだ！
-   **RPTools Alias**：このフィールドは、君のサーバーを RPTools サーバー・レジストリ上に表示するための、サーバーの『別名（エイリアス）』を設定することができる。これは基本的にプレイヤーたちに『IPアドレス 123.45.678.9 のサーバーに接続してくれ』と言うかわりに『Sugoi Server という名前を見つけて、そこに接続してくれ』と言うためのものだ。
-   **Passwords**：パスワードを設定することで、君のサーバーへのアクセスを保護することができる。サーバーへのパスワードの設定は必須ではないが、設定しなければ、君のサーバーを見つけられる誰もがプレイヤーとして接続可能になる。ここには二つのパスワードのカテゴリーがある：
    -   **GM**：GMパスワードは遠隔地にいる者へ、キャンペーンへの全ての操作権限を与えるために使用される。しかし、キャンペーンの読み込みなどのいくつかの機能は遠隔操作できない。通常、GMパスワードはサブマスターがGMの作業を分担できるようにするために使用されるが、GMが適切にホスティングを開始できず、プレイヤーの1人がセッションをホストする、といった場合でも使うことができる。
    -   **Player**：プレイヤーとしてサーバーに接続する人は、接続のためにこのパスワード使うことになる。

#### 『Ownership』、『Vision』、及び『Behavior』

-   **Strict Token Ownership**：MapToolは“token ownership”と呼ばれる概念を用いる。これは、特定のトークンの操作（選択、移動、[プロパティを見る](Macros:Glossary#P "wikilink")）をどの参加者が行えるかを制御するためのものだ。*Strict Token Ownership*を有効にした場合、特定のトークンの*owner*だけがトークンを自由に動かすことができ、その他の人はトークンを見ることしかできない。
-   **Players can reveal vision**：MapToolには視覚（vision）と戦雲（fog-of-war）の（トークンがマップを『見る方法』が設定する）システムが備わっている。このオプションを有効にした場合、プレイヤーはGMの介入無しにトークンの『見える範囲』を公開することが可能になる。（言い換えれば、 トークンにとって隠された範囲は Fog of War で覆われており、画面上に不透明なものを表示する。これを公開した場合、不透明な覆いが消え、園下のマップが見えるようになる）。そうしないのであれば、マップの公開は、全てGMが行わなければならない。
-   **Use Individual Views**：上記で述べた視覚のシステムにおいて、プレイヤーのトークンが視覚を『共有』できるか（*例：*あるキャラクターが見ているものを全員が見る）、又は、個人用の視界を持つのか。
-   **Restricted Player Impersonation**：プレイヤーが演じることができるのは、自分が所有権（ownership、上記参照）を持つトークンのみに制限する。
-   **Players Receive Campaign Macros**：MapTool では[マクロの機能を提供する](Macros:introduction "wikilink")。マクロとは、基本的には一定の活動を自動化するために使用する、一連のテキスト、トークン、ダイス振りコマンドのことだ。基本的に、*何を行うか*手順を記した短い文章である。このオプションを有効にした場合、GMは全てのプレイヤーが利用可能な『キャンペーンマクロ』を作成することができる。
-   **Use Tooltip for \[\] rolls**：このオプションを有効にすることで、各括弧で閉じられたダイスロールはいずれもロールの結果のみを表示し、ロールの完全な詳細はロール結果にマウスポインタをかざすことで表示されるようになる。

### 接続のテストを行う

サーバーを開始する前に、**Test Connection（接続テスト）**ボタンを押すことは良いことだ。これはRPTools.netのサーバーに君のコンピューターへの接続テストを依頼する。要するに、RPTools接続テストサーバーがネットワーク越しに君のコンピューターを認識できるかどうか調査することだ!

**成功！このコンピューターを見つけることができました！**と表示されたのであれば、 サーバー実行時に他の人がサーバーを見つけることができると考えて間違いないだろう。

接続テストの成功のメッセージを*確認できないのであれば*、正しいポートを設定しているか、その他もろもろの設定が万事滞りなくできいるか調べる必要があるだろう。

### 接続情報（Connection Infomation）を取得し、仲間に伝える

![](mt-file-menu-cinfo.jpg "mt-file-menu-cinfo.jpg")

![](connection-info.jpg "connection-info.jpg")

ここでは接続テストに成功し、**OK**を押してサーバーを開始したことを前提に話を進める。設定を再確認するために *Connection infomation* を詳しく確認することにしよう。以下は、仲間がサーバーに接続できるようにするために必要となる設定だ。

1. メニューより **File &gt; Connection Information** を選択。

MapTool が現在認識している君のコンピューターの情報が表示される。まだサーバーを起動していないのであれば、コンピューターの外部IPアドレスと内部IPアドレスが表示される。（この情報は有用であるが、ポートフォワーディングの設定をまだ行っていないのであれば特に重要である）

サーバーの開始しているのであれば、サーバーの名前（設定している場合のみ）と、サーバーが通信に使用しているポートも表示されるはずだ。

2. 仲間に次の情報を伝える：*Server Name（サーバー名）*（RPTools Aliasとも呼ばれる。設定している場合のみ）、*外部*IPアドレス、*ポート番号*。この情報は、仲間が君のサーバーに接続するとき **Conect to Server** ダイアログ上で情報を入力する際に必要になる。

MapTool サーバーに接続する
--------------------------

ここまでの手順で、他の人がMapToolサーバーに接続できるように設定することを説明してきた。もちろん、サーバーに誰も接続させないのであれば、さまざまなことはすぐに退屈なことになるだろう。 ここで説明する手順は、君が立ち上げた*サーバーに接続する君の仲間*を対象にしている。

### 前提

ここで学ぶ内容は、次に示すことを全て満たしていることを前提とする。次のうち1つでも満たしていなければ、非常に短い旅行になるだろう。

-   友達がいる。
-   マップツール・サーバーを立ち上げている。
-   友達は下記の内容を把握している：
    -   サーバーの*名前*、または、サーバーの*外部IPアドレス*。（できれば両方！）
    -   割り当てた*パスワード*（GM用かプレイヤー用のうちどちらか）
    -   サーバーが使用している*ポート番号*
-   **とても重要：君の友達が使用しているMapToolのバージョンが、サーバーのMatpToolと同じバージョンであること!!**

### 『Connect to Server』ダイアログを開く

![](mt-connect-to-server.jpg "mt-connect-to-server.jpg")

上記の条件を満たしているなら、友達に伝えることは次の通り：

1. **File → Connect to Server** を選択し、 **Connect to Server** ダイアログを開く。

2. *User name* を入力。友達が望む名前で構わない。

3. パスワードを入力（サーバー起動時に設定したもの）。

4. 接続する人の*Role*を選ぶ。GMまたはプレイヤーとして接続することができる。パスワードに対応している適切な Role を選択しているか確認すること!!

### 接続方法を選ぶ

**Connect to Server** ダイアログには起動しているサーバーに接続する3つの方法が表示される。

#### RPTools.net

![](mt-connect-registry.jpg "mt-connect-registry.jpg")

このタブ（標準で表示）には RPTools.net の *Server Registry* に登録されたすべてのサーバーが一覧表示される。サーバーを準備するときに、 *alias* を選択した場合、この一覧に表示される。*Server Registry* にはサーバーの接続情報が保存されているので、君の友達はサーバーを選択し**OK**をクリックするだけで良い。

#### LAN

![](mt-connect-lan.jpg "mt-connect-lan.jpg")

このタブには**ローカル・ネットワーク**内で起動しているサーバーが表示される。これはMapToolのLANパーティを開きたいときや、友達が全員同じネットワーク上にいるときのためのものだ（みんながゲーム会にノートパソコンを持ち寄ってくるときなど）。

#### Direct

![](mt-connect-direct.jpg "mt-connect-direct.jpg")

直接接続とは、簡単なRPTools.net タブを使用せず、サーバーの外部IPアドレスとポート番号を入力して接続することだ。

### 接続の確認

友達がMapToolサーバーに接続したとき、誰かがサーバーに接続したことが**Chat Pane**に次のように通知される。

<font color="blue">*JQRandom has connected.*</font>

また、**Connections Pane** でサーバーに接続している参加者全員の一覧が確認できる。Connections Pane を表示するには、**Window → Connections** を選択すること。

マップ上のトークン
------------------

君がMapToolを自分で使うために起動した場合、MapToolは君をGMと見なすので、マップ上のトークンとアイテムを扱うことができる。（つまり、マップが象徴する小さな世界の全能神となるわけだ。）しかし、ゲームをホスティングしているとき、MapTool は接続する人たちのために、これまで説明してきたように異なる役割を持っている。**GM**の役割ではマップ上のすべてのものを選択し、操作することができる全権を保持するが、**Player**の役割ではプレイヤーの*ownership*が設定されているアイテムだけを扱える、非常に制限されたことしかできない。

上記の理由により、君がサーバーを立ち上げたときは、プレイヤーが担当するトークンを操作できるように ownership を設定しなければならないだろう。プレイヤーが接続した後にトークンの所有権を設定し忘れるのは、新しいサーバーを立ち上げたときに見落としがちな落とし穴だ。

トークンの所有権は[はじめてのトークンにて詳しく説明しいる](Introduction_to_Tokens/ja "wikilink")。しかし、このチュートリアルの目的は、サーバーを立ち上げ、君の友達をプレイヤーとして接続させ、ゲームに接続した各々のプレイヤーに次に示すことを行うことである。

1.  プレイヤーが担当するキャラクターのトークンをダブルクリック（下記の注記を参照）。
2.  token type を PC に設定。
3.  **Ownership** タブを開く。
4.  所有権を与えるために該当する *プレイヤーの名前*の先頭にあるチェックボックスにチェックを入れる。
5.  設定を有するために **OK** をクリックする。

以上の操作で、そのプレイヤーは自分のトークンを動かしたり情報を編集したりすることができるようになる。

また、全員がトークンを操作する必要があるのであれば、トークンの所有権を全てのプレイヤーに与えることもできる。

**注：**君が望むのであれば、NPCトークンの所有権をプレイヤーに与えることもできる（操作方法は手順2を除いて同じ）が、少なくとも各プレイヤーの担当するトークンに所有権を与えなければないないだろう。

<Category:MapTool>