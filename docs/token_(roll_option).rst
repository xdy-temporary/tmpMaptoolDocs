================================
token (roll option) - MapToolDoc
================================

.. contents::
   :depth: 3
..

.. container:: noprint
   :name: mw-page-base

.. container:: noprint
   :name: mw-head-base

.. container:: mw-body
   :name: content

   .. container:: mw-indicators

   .. rubric:: token (roll option)
      :name: firstHeading
      :class: firstHeading

   .. container:: mw-body-content
      :name: bodyContent

      .. container::
         :name: siteSub

         From MapToolDoc

      .. container::
         :name: contentSub

      .. container:: mw-jump
         :name: jump-to-nav

         Jump to: `navigation <#mw-head>`__, `search <#p-search>`__

      .. container:: mw-content-ltr
         :name: mw-content-text

         .. container:: toc
            :name: toc

            .. container::
               :name: toctitle

               .. rubric:: Contents
                  :name: contents

            -  `1 [token():] Roll
               Option <#.5Btoken.28.29:.5D_Roll_Option>`__

               -  `1.1 Usage <#Usage>`__
               -  `1.2 Examples <#Examples>`__
               -  `1.3 See Also <#See_Also>`__

         .. rubric:: [token():] Roll Option
            :name: token-roll-option

         .. container::

            Â Note: This function can only be used in a `Trusted
            Macro </rptools/wiki/Trusted_Macro>`__

         .. container::

            \* **Introduced in version 1.3.b48**

         **token** is a macro function that allows an associated code
         block to be executed as though it were executing with a
         specified token as the context. This allows the code block to
         use properties of the token without special coding.

         This "context" function lasts only for the given code block.
         References to variables within the code block will still be
         available when the code block finishes. (Variables belong to
         the macro, while properties belong to the token.)

         .. rubric:: Usage
            :name: usage

         .. container:: mw-geshi mw-code mw-content-ltr

            .. container:: mtmacro source-mtmacro

               #. .. code-block:: none

                     [token(identifier): single_statement]

         .. container:: mw-geshi mw-code mw-content-ltr

            .. container:: mtmacro source-mtmacro

               #. .. code-block:: none

                     [token(identifier), code: {

               #. .. code-block:: none

                        statement1

               #. .. code-block:: none

                        statement2

               #. .. code-block:: none

                     }]

         The *identifier* is the name of the token. The search first
         checks to see if the specified string is the Name of any token
         (i.e. matches `token.name </rptools/wiki/token.name>`__), then
         it checks GMName (i.e. matches
         `token.gm_name </rptools/wiki/token.gm_name>`__), and last it
         checks the unique `token
         id </maptool/index.php?title=TokenID&action=edit&redlink=1>`__
         (this is a 32-character string generated by MapTool).

         If there are multiple tokens with the same name, such as
         **Goblin**, then the *GM Name* field of the token should be
         unique so that it can be used to select tokens. Note that the
         `getAllTokens() </maptool/index.php?title=Macros:Functions:getAllTokens()&action=edit&redlink=1>`__
         and related functions return a list of token ids.

         .. rubric:: Examples
            :name: examples

         .. container:: mw-geshi mw-code mw-content-ltr

            .. container:: mtmacro source-mtmacro

               #. .. code-block:: none

                     [h, token("Goblin 21"): health = floor(100*HP/HPmax)]

               #. .. code-block:: none

                     The healthbar of <b>Goblin 21</b> should be at [r: health]%.

         If **Goblin 21** has 32 hit points and a maximum hit points of
         40 (and these numbers are stored in **HP** and **HPmax**
         properties, respectively), the output produced will be:

         ``The healthbar of Goblin 21 should be at 80%.``
         .. rubric:: See Also
            :name: see-also

         `currentToken() </rptools/wiki/currentToken>`__,
         `switchToken() </rptools/wiki/switchToken>`__,
         `floor() </rptools/wiki/floor>`__.

      .. container:: printfooter

         Retrieved from
         "http://lmwcs.com/maptool/index.php?title=token_(roll_option)&oldid=4189"

